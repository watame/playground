# BASEの新規事業チームのBASE BANKチームの技術選定と歴史
BASE株式会社　柳川 慶太 @gimupop
BASE株式会社　清水 陽一郎 @budougumi0617

## アイスブレイク
- 持って帰ってほしいこと
    - 決心や勇気が正しいと思う心
    - どういう気持ちで技術選定すると良いかが伝われば良い

## 何を考えて技術選定したか
不確実性が高いプロダクトだったので。。。
- 新規事業に必要なもの
- とにかく早く出す
- 素早く改善サイクルを回し続けられる

言語とか細かいアーキテクチャはへのこだわりはなかった
-> それよりも要件ヒアリングと詳細設計がしたい！

アーキテクチャなどは別の人と分業制で対応
-> うまくはまった！

### まとめ
- 既存システムと切り離したAPI
- 自分達で**素早く決めて実行できる状態**を作るのが大事
- 新規事業はノリと勢いが大事
- 迷ったら
    - 気分が乗るほう
    - 迷ったらオーナーシップが持てる方をやる
- 考えた技術には支持者がつくよ

技術選定には「自信」が持てることが大事。

## 3年間チームで開発し続けて思ったこと
### 選定で良かったこと
- アジャイル
    - 仮説検証の高速フィードバックできる
- フルスタック
    - チームメンバーがフルスタックだった
    - 作業依頼がないことによってスピード感のある開発ができた
    - ゼロベースで設計を考える点で良いかなと思う
    - ただ、難度は高い
- フルサイクル
    - 企画から問い合わせまで自分達でやる
    - 自分達が全てに関わることで**自分達**で加速できる
        - 運用で得られる気づきもある
    - https://techblog.cartaholdings.co.jp/entry/2019/02/04/171325
- プロダクトに集中できる技術
    - 課題、複雑さはプロダクトに依存している？
    - 言語の癖で複雑になっているかも
    - プロダクト思考にシフトし、技術に捉われない

### プロダクトにとらわれない技術選定
- 独立したアーキテクチャを実装することで、フィードバックサイクル回している

#### Go
- プロダクト以外の問題が少ない
- 環境構築が容易
- バージョンアップ楽
- コードフォーマットが固定
- 言語仕様がミニマム

#### Python
- 機械学習エンジニアがAPIサーバーをメンテできる
- 容易に機械学習系ライブラリを利用できる

#### AWS ECS on Fargate
- コンテナ
- アプリエンジニアでもメンテが容易
    - マネージドなので深い考慮が不要

#### Terraform
- AWSリソースの可視化
- 認知負荷の軽減につながる

#### 共通ライブラリ
- DB操作、HTTPサーバーの基本機能、運用で必要な仕組み
- CI/CD

## まとめ
- 自分達で決め続けることが大事
    - スタートの技術選定でオーナーシップがあったことがよかったのかなぁ
    - グロースを見据えた拡大に耐えられるように納得感を持つ必要がある
- チームがプロダクトに向き合う時間を最大化できることが大事
    - チームが学習できるか
        - 裁量をもって決断できる
        - 試行と反省の回数と速度を最大化できる

## 資料
- https://speakerdeck.com/budougumi0617/how-to-decide-technology-selection-for-startup
- https://speakerdeck.com/hgsgtk/a-strategy-to-choice-no-knowledge-technology

# Full TypeScriptで新規プロダクトを立ち上げた際に実践した設計と反省
株式会社カケハシ　小室 雅春 @_hadrall

## 背景
患者さんの服薬を薬局がサポートするための業務システムを作りたい
- 明確な期日はないが3,4ヶ月でリリースしたい
- 正式リリース、スケールする前提

**とにかくスピーディーにプロダクトを立ち上げて、マーケットに合わせて行きたい**

### システムの特性
- SPAアプリ
- SSO
- 将来的に実装されうる機能が特定しきれていない

## 技術選定と設計
### 選定の視点
- 開発速度
    - 軽量な技術スタックでサイクルを短縮
    - 新興ツールでも利用
- シンプル
    - メンバーの入れ替えあるかも
- 属人化しない
    - 整理されつつ、複雑化しないアーキテクチャ

### TypeScript
- フロントエンドで必ず使う
- 全部TypeScriptで開発できる
- フルタックメンバーが多かった
- 型によるドキュメンテーション効果

### レポジトリ管理
モノリシックレポジトリ。
-> backend, frontend, infra などが１つのレポジトリに入っている

- 一部コードを共有したい
    - ドメイン情報やコアロジックを共有する
- 気をつけないとダメなところ
    - 循環参照

### アーキテクチャ
2つのアーキテクチャを混ぜて使った。

- クリーンアーキテクチャ
    - ロジックの置き場を整理
    - コンポーネントを差し替えるようにする
- DDD
    - ドメイン要件をコードに反映しやすくする
    - ドキュメンテーションとしての価値を高める

#### ドメイン情報を通信に含める
- DTO
    - ドメイン情報の変更に耐えうる構造とする

### フロントエンド前提
- フレームワークに依存したくない
    - フレームワークの方が早いが、後々コストになるかも
- 判断のポイント
    - toCかtoBで非機能要件が異なるので、そこは検討すること

#### React
- 内部が全てJS
- TSによるドキュメンテーション効果が高い
- ビルド開発環境が選びやすい
#### ビルド
- esbuild
- ローカルはexpressとbrowsersyncでホスト
#### パッケージ
- pnpm
- Inversify.js
    - DIコンテナ

### ドキュメンテーション
- OpenAPI
    - TSOAを採用
    - CodeFirstでOpenAPIスペックを生成できる
    - 手間なく、フロントバックの整合性を担保できる

### Testing
- Testing Trophy を念頭にしている
    - https://testingjavascript.com/
    - 最終的にはインテグレーションテストを主体とする
        - 統合テストはDBをモックしないこと

- よかったところ
    - 機能全体がテストできるから安心感ある
    - 障害が発生した場合に、修正異国の動作を保証できる
- 悪かったところ
    - テストデータの作成が大変
    - 局所的に複雑なロジックもある
    - Jestの起動が遅い？

## まとめ
- 新規プロダクトの構築に際して、軽量な開発環境を工夫することで、順調に開発＿リリースできた
- 次のプロダクトを立ち上げるときに検討すべき事象がわかった

# LINEでライブコマースサービスを新規に立ち上げた際の技術選定
LINE株式会社　岩谷 明

## アイスブレイク
- 持って帰ってほしいこと
    - 個別の事例を応用してくれると嬉しい

## サービス概要
LINE LIVEBUY
- LINE上で視聴・購入まで完結できるサービス

## 技術選定の理由
### 背景
- インフラ
    - LINE以外にもたくさんのサービス
    - ほぼ全てオンプレミス
        - それ上にプライベートクラウドがある
- 言語
    - Javaの知見が大量にある
- テックスタック
    - さまざまなミドルウェアをメンテしているチームがいる

### 新規サービスをどう作ろう？
- エンジニアであればテンションが上がる瞬間
    - 技術選定は各チームに裁量がある
    - 最新技術をキャッチアップするのは大事
    - とはいえ、社内の財産を使わないのはもったいないなぁ

**技術選定 = プロジェクトの特性 * 環境 * チーム構成**

LINEの場合は、フロントバックとインフラで分かれていた + インフラも別チーム

#### 環境・特性 -> マイクロサービスアーキテクチャを採用
- 良いところ
    - ドメインごとに完全に分かれる
    - 各サービスの台数を簡単に増減できる
- 悪いところ
    - どんな順でデプロイしても平気なコードを書く必要がある
    - Kubernetesは大変
    - アプリケーション開発者がメンテしないとダメ

#### 環境・特性 -> Kotlinを採用
- 良いところ
    - Javaの資産を活かせる
    - すぐに慣れた
    - 非同期が書きやすい
- 悪いところ
    - 目立ったところはない

#### 環境・チーム -> gRPCを採用
- 良いところ
    - APIドキュメント整備で消耗しなくなった
- 悪いところ
    - 環境整備に時間がかかる

#### この技術選定は正解だった？
- リリース後も大きな障害なし
- 開発速度も遅くない
- メンバーが少ないのにマイクロサービス
    - 将来を見越したチャレンジ、作り込み
    - 実際に方向転換や大きな機能追加でも作りやすかった

### まとめ
- 技術選定
    - 財産の活用と新規技術とのバランス
    - 唯一解はない
    - 選択が正しかったことがわかる日はだいぶ先

## QA
### 技術選定でどのくらいの期間をかけたか
- 1week ~ 2week くらいで決める
    - あとは実際に使ってみてから決めることが多い

### 技術選定のゴールは？
- CTOとかに見てもらう
- チーム内のコンセンサスをとる

### 「ああしておけばよかったな」という技術的反省
- データモデルの設計
    - 捨てても良いのであれば、ミューテーションできるが、継続すると無理
- 作り込みすぎたり、技術的に速すぎたりで先行事例がなくて困ったりもした
- 別サーバーでスキーマ駆動できないなど、ツールによって敗因があったりする

### フルサイクルはどのような体制でしているのか
- ユーザーインタビューの意見をチーム内で検討する
    - 意見をそのまま採用するわけではなく、真意を確認するようにしている
- 職種問わず、**全員プロダクトサイクルに関わる**ようにしている

### 詰まったときに乗り越えるやり方は？
- 相談相手がいることが大事
    - 頼れる仲間や部署の方がいることが心強い

### 新規事業への適正がある人は？
- このスキルがないと、この適性がないと、というより**自分にできることとできないことを客観視できること**が大事
    - できないことを理解して、他人に助けを求められることが大事
- コミュニケーションができるひと
    - 既存のプロダクトなどを権限移譲してもらえる人
- なんでも楽しめることが重要
    - 楽しくもあり、辛くもある部分
    - 自分達がゼロから作ることを楽しめることが大事
