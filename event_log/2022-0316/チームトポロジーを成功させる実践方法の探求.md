# チームトポロジーを成功させる実践方法の探求 - Team Topologies Study

# Twitter
* #ちいとぽStudy

# 30分でわかった気になるチームトポロジー
## 発表者
* 吉羽 龍太郎

## 今の世の中
* 技術・人・ビジネスの変化が早くなった
* システム構築に多くの人が必要
* だけど、従来の組織構造や仕事のやり方はこの状況に対応できない
* 素早く顧客価値を得ないと会社潰れる

## 4つのキーメトリクス
* デリバリーのリードタイム
  * 欲しいとなってから届くまでの時間
* デプロイの頻度
* サービスの復旧所要時間
* 変更失敗率
  * デプロイが成功する割合

※ベロシティを重要視すると何か変更があった場合に辛くなるので、指標としては不適切

-> 顧客に素早く頻繁に安定的に価値を届ける、問題あれば素早く復旧
  -> 安定した速いフローを重視する

* 速いフローを阻害する要因
  * 組織や、ハンドリングする案件など、
  * 組織設計による混乱
  * 大きすぎるソフトウェア

* チームトポロジー
  * フローを実現するための者
  * 公式ではなくパターン（フレームワーク）
    * チーム構造やコミュニケーションのパターン
    * チームの状況によって変わる

* チームトポロジーが重視するもの
### 1. コンウェイの法則
システムを設計する組織は、そのコミュニケーション構造をそっくりそのままのシステムを生み出しちゃう
-> 組織設計によってソフトウェア設計が限定されちゃう
  -> つまり、職能別の組織だったりするとめちゃくちゃコミュニケーションコストがかかったりする
  -> また、組織設計のほうがソフトウェア設計よりも強いのでソフトウェアが組織に引きずられる

#### 逆コンウェイ戦略
コンウェイの法則を踏まえて、それを戦略的に活用した組織設計を目指す
-> フローの実現ができるようにチーム設計・ソフトウェア設計を行おう

### 2. チームファースト
スキルで分業する構造だと引き継ぎが発生してデリバリーが早くならない。
-> チーム構造をデリバリーしやすい構造にしよう（逆コンウェイ戦略）
  -> チームを最優先で考え、権限とスキルを持つチームをアジリティの土台となる
  -> 個人ではなく、チームでの成果達成が最優先

#### よくある落とし穴
* チーム間の情報共有を増やそう
* チーム間の連携やコミュニケーションを活発にしよう

-> リードタイムが遅くなるから、何でもかんでもコミュニケーションするのは良くない

1チームはMAX10人が限界
-> 増えるほどコミュニケーションパスが複雑になる
  -> チーム間のコミュニケーションパスでも同じことがいえるので、独立したプロジェクトとしての連携もこれに添わせるべき

#### The API Mandate
全チームはI/Fを通じてデータや機能を公開する
プロセス間通信は一切認めない。
-> どのチームも連絡をするI/Fが決まっているので、不要なコミュニケーションを取る必要がない

#### タックマンモデル
チームが機能するのには段階がある
-> 段階を踏むのには時間がかかる（3ヶ月、半年）
  -> 仕事が終わるたびにチームを壊すのは非常に効率が悪い
    -> **ハイパフォーマンスなチームを解散するのは、めちゃくちゃもったいない**

プロジェクトやプロダクト -> チーム
ではなく
チーム <- プロジェクトやプロダクト
のようにチームにプロジェクトやプロダクトを割り当てるようにしよう

#### チームの認知負荷を考慮する
人間がとどめて置ける情報の量には限りがある
-> やりすぎるとモチベ下がる

少なくともストレスが高い状態だと自律的に働けないので、そんな環境にならないようにしよう

#### 認知負荷に合うように責任範囲を制限する
**チームが扱うソフトウェアのサイズを制限する**
**チームの認知負荷に合わせてソフトウェア境界を選ぶ**
-> だいたいドメインで分けることが多い

* チームの境界を決める節理面（ドメイン以外のやつ）
  * リスク
  * パフォーマンス
  * 地理
  * 技術

-> 全ては長生きするチームを作るための行動、チームが長く働けるようにしよう

### 3.チームＡＰＩ
チームが行う仕事、やり方のIFを定義しておこう
-> 他のチームとやり取りするときに利用する方法を明確にしておこう

チームAPIをテンプレートにして共有すること！

### 4. 4つのチームタイプ
チームのタイプに応じた目的・役割・責任をおわせよう

#### ストリームアラインドチーム
ビジネスの主な変更フローにそって配置するチーム
-> 最も主となるチーム
  -> 他のチームはこのチームのサポートを行う
職能横断型で、他のチームを待たずにデリバリーできる

#### プラットフォームチーム
内部サービスを提供するチーム
共通基盤提供を行うチーム
-> よく使う機能を隠蔽して、他のチームの認知負荷を下げよう

#### イネイブリングチーム
実作業をするのではなく知識やテンプレート等の情報を提供する。
特定の技術、製品、プロセスのスペシャリストから成る。
-> 短期で他のチームと関わり、スキルトランスファーしたら離れる

#### コンプリ系てぃっど・サブシステムチーム
特殊スキルが必要な業務をおこなうチーム
-> 機能をいんぺいして、他のチームの認知負荷を下げる

## 5. 3つのインタラクションモード

### コラボレーションモード
2つのチームが一緒になって、探索や実験を行いながら学習をする
-> わからない事が多い段階にとられる

### x-as-a-Serviceモード
他のチームが提供した機能をブラックボックスとして、他のチームが利用する
-> 明確に責任境界が切られている
  -> 境界部分のイノベーションは起こりにくい

### ファシリテーションモード
他のチームを支援する場合にとられる

## 6.組織的センシング
環境の変化を感知できなければ、やることは意味をなさない
-> 社会、チームから色々なことを気付き、反映しないと無駄なことをしてしまう

## 7.トポロジーを継続的に進化させる
時間の変化によってトポロジーは変わる
-> チームは緩やかに変わっていく

### チームトポロジーを見直すきっかけ
ソフトが大きくなりすぎてる
デリバリーのリズムが遅くなってる
ソフトの依存関係が大きくなっている

-> 一度立ち止まって、どう変化させたら良いかを考えよう

**絶対に一気に変えようとしない！緩やかに組織構造を変えるようにしよう**

# スライド
* https://www.ryuzee.com/contents/blog/14566


# 組織をチームトポロジーで振り返ると、よりよい未来が見えてくる
## 発表者
* 亀田さん

## チームトポロジーの価値
共通言語としての価値が高い
-> プログラムでいうところのMVCなど、デザインパターンとして利用できる
-> 共通言語の獲得により、組織全体で向き合うことが出来る

## 前提となる事業や組織の情報
サービスの仕組み
* 特定の時間だけ働きたい人をマッチングするサービス

* 登場人物
  * クライアント
    * ワーカーを雇う人
    * 直雇用契約を行い、労務管理はサービスで行う
  * ワーカー
    * アプリインストール
    * 現場に行ってすぐ仕事、すぐにお給金もらえる
  * 社員
    * ワーカークライアントのサービス利用推進

* 事業の時間軸
  * サービスを広げる中で、コンテクストがドンドン変わってくる
    * 経営の時間軸
      * 1ヶ月, 2ヶ月, 3ヶ月, 半年, 2-5年 のように時間軸が変わってくる

## チームトポロジの遷移
### ワンチーム時代
チームで話されている話題に自分の開発箇所が関わっていないから、疎外感あるかも
-> 技術面での分割（アンチパターン）

### Phase2のチームトポロジー
Rails
-> 全ての機能を把握する必要があり、ソフトウェアをする

MobileApp
-> 習熟化進んだけどＡＰＩが実装できていなくて届けられない、、、萎える
  -> サービスに対しての自律性が下がる

Data
-> チーム間のＡＰＩを規約を基にチーム間のインタラクションができた

### Phase3
節理面はステークホルダー
チーム主導で課題回収から解決&運用まで回るようになった

* クライアントの閉じた改修がワーカーチームのSLOに影響を与えた
  * クライアントチームの影響がワーカーチームに影響を与えた
    * 出退勤
      * クライアントでもワーカーでもある
        * コラボレーションが必要にならざるを得ない
          * リリースサイクルが遅くなるし、コストもかかる
-> 新たな節理面を探す必要があるな

### これからどうしようか
節理面を分ける際に大切にした問い
* 認知負荷が軽減すること
  * 切ったボリュームに応じて認知負荷が軽減されるのか？
* 再帰的に分割しうること
  * 10倍規模になった際に継続して主たる節理面である想像がつくか？
    * つまり、節理面とした箇所をドンドン切っても深堀り出来そうか？
* バリューストリームが事業成果につながること
  * 自律的にチームを切った先の目的が事業成果に繋がっていればOK
  * マッチング
    * 稼働率を高めることで人を呼ぶ
  * スポットワークシステム
    * 信頼性・拡張性を高める
* 技術的な戦略と一致すること
  * マッチング
    * データのFBループを実現できる
    * 習熟が起きやすい
  * スポットワークシステム
    * 可用性（出退勤）、結果整合性（給与）が必要

-> 節理面について、ドンドン見直ししながら進めていきたい

# スライド
* https://timee.notion.site/Team-Topologies-Study-98b49ec983c64965a98595456873e6f1


# QA
* チームトポロジーにおけるチームには自立し向上心を持つメンバーが前提になると思いますが、期待に届かないメンバーや自ら向上しづらいメンバーをどのように評価し取り扱えばいいかという考え方をお聞かせください。
  * アジャイルの思想をめちゃくちゃ受けているので、前提としてモチベーションがあること
    * 本当にやる気ない？
      * その人のパーソナリティになった背景があるので、事実をとらえるところから入ったほうが良い
    * 本当に能力がない？
      * チームで学習する機会を作ればよい
  * 環境とかではなく、構造的に発生する
    * 期待に答えるケイパビリティが非常に高い
      * 求められる前提能力が非常に高い
        * **期待に応えられるサイズの認知負荷に分割することが大事**

* 開発も運用も全部できるエンジニアが採用できないという制限がある中で、止むえず開発と運用を分けている会社もあると思います。開発と運用でわけることでチームの拡大に対してネガティブになることを、改めて挙げていただけると嬉しいです。
  * 変化にすごく弱くなるし、変化を作りにくい
    * ここはボトルネックになりやすい
    * 変化する可能性があるのであれば、探索が可能になるので開発と運用を一緒にするべき
      * チームを分断するとフローが遅くなる
      * 実環境からのフィードバック反映が受けにくいから変化に対応出来ない

* 逆コンウェイ戦略で組織構造を作っていくことはアーキテクチャが既に構築されていること、もしくは柔軟に変更できるが前提だと思います。モノリシックなアーキテクチャではこの戦略は取りにくいと考えています。逆コンウェイが採用しやすいアーキテクチャ、採用しくいアーキテクチャなどはありますか?
  * 複数のチームが1つのコードを触ること自体がしんどい
    * モノリスを分割したいタイミングは1チームでは面倒が見切れなくなったタイミング
      * 認証、課金サービスを切り出す
      * 「モノリスからマイクロサービスへ」オライリー
  * 分割をする
    * 干渉しづらくすることで障害を減らす
    * 逆コンウェイで境界面を探索することが出来ると、自分たちにあった領域が見つかる

* タイミーの将来のチーム構成（チームトポロジ）はどのようなメンバーで考えていかれたのでしょうか？お一人で考えられたのでしょうか？
  * アイデアは30%くらいで考えて、PMとの擦り合わせを行いつつ進めている

* ストリームアラインドチーム以外のチームを組成するタイミングはどう見極めるのが適当でしょうか？
  * キーワードは「認知負荷」
    * 構成を変更することがチームを変えることになる
    * 今までより遅くなっている、認知負荷が高い、と思ったタイミングが変更のタイミング
    * インフラは境界としてわかりやすいので、わけやすい
  * スキルの獲得は「内製負荷」となる
    * この負荷を乗り越えることでチームが成熟する

* 小さく失敗することが基本原則？組織は小さく失敗することが出来ないように思うけど。。。
  * 失敗したらロールバックできるようにすればよい
  * 結局実験なので、1つ当たれば良いのでは？というマインド
    * 確実性を求めて時間をかけるほうがマイナス
  * 何かあった時に気付けるようにしよう（センシング）
    * 人はエラーを戻さない
    * 人が発するシグナルを検知する必要がある
      * アラートを上げやすい環境を作ろう

* チームの認知負荷を下げるためにプロダクトの（相対的に価値の低い）機能は捨てる必要性があるでしょうか？また、その議論をどう進めれば良いでしょうか？
  * 捨てれば良い
    * 残すだけで認知負荷が高くなる
    * **機能を削除するというプロダクトバックログを入れる**
      * 測定する仕組みがないとダメ
  * チームによって見え方が違うから重みづけは難しい
    * 捨てるコストの大きさについて確認する事が大事
  * エンジニアじゃない人に捨てることの大事さをどのように伝える？
    * 機能自体は点で運用をすると線になる
      * 時間軸によって複雑性が増えていく
      * 必要でない機能を作って後悔することが多い。。。
      * **もともと複雑な機能をシンプルにすることも大事**
    * なぜ捨てたいのか、捨てたときのメリット・デメリットは説明する必要がある（説明責任を果たす）

* 捨てるための話、興味深いです。プラットフォームチームの立場だと捨てるのが非常に難しい（ひたすらにコラボレーションモード）のですが、コツはありますでしょうか。
  * 初期段階で組織とか会社にとってどんなプラットフォームが必要かってことを判断しないとダメなのであれば、捨てられる段階には進みにくいかと
    * API段階まで進めれれば捨てることも可能かと
  * プラットフォームが握っているスキルを捨てるのは無理
    * **最初に選んだ技術スタックには向き合い続ける必要がある**
